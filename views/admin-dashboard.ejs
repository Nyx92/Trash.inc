<%- include('dash-nav'); -%>

<!-- Banners -->
<div class="wrap-profile">
  <div class="banner-dash"></div>
  <div class="profile-details">
    <a class="profile-pic-dash" href="http://localhost:3004/dashboard">
      <img src="./buttercups.jpg" alt="profile-pic" />
    </a>
    <p class="username"><strong><%= finalData[0].user %></strong></p>
    <button class="edit-profile-button">Edit Profile</button>
  </div>
</div>
<!-- End of Banners --> 

<div class = table-buttons-wrapper>
  <div class = "toggle-table">
  <h2>Toggle Tables</h2>
  <button class="table-button-fulfilled">
    Fulfilled Orders
    </button>
    <button class="table-button-unfulfilled">
      Unfulfilled Orders
    </button>
    </div>

    <div class = "sort-table"></div>
      <h2>Sort Tables</h2>
      <button class="sort-postal-button" onclick="sortTable()">
      Sort Postal
      </button>
</div>


<!-- Content Container for Unfulfilled recycle orders  -->

<div class="content-container-unfulfilled-dash-admin">
  <div class="table-title">
    <h2>Table of unfulfilled recycle orders</h2>
  </div>

  <div class="input-box">
    <!-- once someone types something in the input, function activates -->
    <input
      type="text"
      id="myInput"
      onkeyup="myFunction()"
      placeholder="Filter by typing..."
    />
  </div>

  <!-- Recycling Table -->
  <section class="recycling-table-section">
    <!-- Table columns-->

    <table id="recycling-table">
      <tr>
        <form id = "fulfill-form" action="/fulfill" method="POST">
        <!-- pick an array item, iterate through its keys to create the columns -->
        <% for (let i = 0; i < Object.keys(finalData[1]).length; i++) { %>
        <th class="headers"><%= Object.keys(finalData[1])[i] %></th>
        <% } %>
        <th class="headers">
          <input form = "fulfill-form" class="order-fulfill-button" type="submit" value="Submit" />
        </th>
      </tr>

    <% const filteredDataUnfulfilled = finalData.filter((ele) => ele.order_status === 'unfulfilled'); %>

        <!-- loop through each object in the finalData array (i.e., each recycle order entry) -->
        <% for (let i = 0; i < filteredDataUnfulfilled.length; i++) { %>
        <tr class = "table-body">
          <!-- loop through each key in the object to output the value -->
          <% Object.values(filteredDataUnfulfilled[i]).forEach((x) => { %>
          <td><%= x %></td>
          <% }) %>
          <td>
            <label class= "checkboxes" for = "fulfill-checkbox<%= i %>">Fulfill</label>
            <input
              type="checkbox"
              id="fulfill-checkbox<%= i %>"
              name="fulfill"
              value="<%= filteredDataUnfulfilled[i].id %>"
              />
          </td>
        </tr>
        <% } %>
      </form>
      <!-- add a container which tabulates quantity -->
    </table>
    <!-- End of Recycling Table -->
  </section>
  <!-- End of Content Container -->
</div>

<!-- Content Container for fulfilled recycle orders  -->

<div class="content-container-fulfilled-dash-admin">
  <div class="table-title">
    <h2>Table of fulfilled recycle orders</h2>
  </div>

  <div class="input-box">
    <!-- once someone types something in the input, function activates -->
    <input
      type="text"
      id="myInput"
      onkeyup="myFunction()"
      placeholder="Filter by typing..."
    />
  </div>

  <!-- Recycling Table -->
  <section class="recycling-table-section">
    <!-- Table columns-->

    <table id="recycling-table">
      <tr>
        <!-- pick an array item, iterate through its keys to create the columns -->
        <% for (let i = 0; i < Object.keys(finalData[1]).length; i++) { %>
        <th class="headers"><%= Object.keys(finalData[1])[i] %></th>
        <% } %>
      </tr>

    <% const filteredDataFulfilled = finalData.filter((ele) => ele.order_status === 'fulfilled'); %>

        <!-- loop through each object in the finalData array (i.e., each recycle order entry) -->
        <% for (let i = 0; i < filteredDataFulfilled.length; i++) { %>
        <tr class = "table-body">
          <!-- loop through each key in the object to output the value -->
          <% Object.values(filteredDataFulfilled[i]).forEach((x) => { %>
          <td><%= x %></td>
          <% }) %>
        </tr>
        <% } %>
      <!-- add a container which tabulates quantity -->
      
      <div class="tabulate-quantity"></div>




    </table>
    <!-- End of Recycling Table -->
  </section>
  <!-- End of Content Container -->
</div>

<script>

  function myFunction() {
    // Declare variables
    let txtValue;
    let input = document.getElementById("myInput");
    let filter = input.value.toUpperCase();
    let table = document.getElementById("recycling-table");
    let tr = table.getElementsByClassName("table-body");

    for (i = 0; i < tr.length; i++) {
      td = tr[i];
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
      }
    }
  }
  
  // When unfullfilled button is clicked
    document.querySelector(".table-button-unfulfilled").addEventListener('click', function(){
      //show unfulfilled table
      document.querySelector('.content-container-unfulfilled-dash-admin').style.display = "block";
      //hide fulfilled table
      document.querySelector('.content-container-fulfilled-dash-admin').style.display = "none";
    })

  // When fullfilled button is clicked
    document.querySelector(".table-button-fulfilled").addEventListener('click', function(){
      //show fulfilled table
      document.querySelector('.content-container-fulfilled-dash-admin').style.display = "block";
      //hide unfulfilled table
      document.querySelector('.content-container-unfulfilled-dash-admin').style.display = "none";
    })

  // When sort button is clicked
    document.querySelector(".sort-postal-button").addEventListener('click', function(){
      //show fulfilled table
      document.querySelector('.content-container-fulfilled-dash-admin').style.display = "block";
      //hide unfulfilled table
      document.querySelector('.content-container-unfulfilled-dash-admin').style.display = "none";
    }) 

    function sortTable() {
      let table
      let rows
      let switching
      let i
      let x
      let y
      let shouldSwitch;
      table = document.getElementById("myTable");
    }



</script>

<%- include('footer') -%>
